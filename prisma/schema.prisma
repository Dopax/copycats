generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Ad {
  id              String       @id @default(uuid())
  postId          String       @unique // The Facebook Post ID
  brand           String?
  description     String?
  headline        String?
  adLink          String?      // Facebook Ad Link
  facebookLink    String?      // Facebook Post Permalink
  videoUrl        String?      // URL to the video/image file
  thumbnailUrl    String?
  firstSeen       DateTime     @default(now())
  lastSeen        DateTime     @default(now())
  publishDate     DateTime?
  
  archived        Boolean      @default(false)
  priority        Int?         // 1=High, 2=Medium, 3=Low, null=No priority
  notes           String?
  
  snapshots       AdSnapshot[]
  tags            Tag[]
  
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  formatId        String?
  format          AdFormat?    @relation(fields: [formatId], references: [id])
  
  hookId          String?
  hook            AdHook?      @relation(fields: [hookId], references: [id])

  themeId         String?
  theme           AdTheme?     @relation(fields: [themeId], references: [id])

  angleId         String?
  angle           AdAngle?     @relation(fields: [angleId], references: [id])
}

model AdFormat {
  id    String @id @default(uuid())
  name  String @unique
  ads   Ad[]
}

model AdHook {
  id    String @id @default(uuid())
  name  String @unique
  ads   Ad[]
}

model AdTheme {
  id    String @id @default(uuid())
  name  String @unique
  ads   Ad[]
}

model AdAngle {
  id    String @id @default(uuid())
  name  String @unique
  ads   Ad[]
}

model AdSnapshot {
  id        String   @id @default(uuid())
  adId      String
  ad        Ad       @relation(fields: [adId], references: [id], onDelete: Cascade)
  
  likes     Int      @default(0)
  shares    Int      @default(0)
  comments  Int      @default(0)
  
  capturedAt DateTime @default(now())

  importBatchId String?
  importBatch   ImportBatch? @relation(fields: [importBatchId], references: [id])
}

model Tag {
  id    String @id @default(uuid())
  name  String @unique
  ads   Ad[]
}

model ImportBatch {
  id        String   @id @default(cuid())
  name      String
  createdAt DateTime @default(now())
  snapshots AdSnapshot[]
}
